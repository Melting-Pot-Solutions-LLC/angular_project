
<div class="page-header">
    <!-- MultiStep Form -->

         <div class="row">
            <div class="col-xs-12">
                <form id="msform" [formGroup]="actionUserForm">
                    <!-- fieldsets -->
                    <fieldset>
                        <div class="progressbar-div" *ngIf="!contactForm">
                            <ul id="progressbar">
                                <li class="active">Property info</li>
                                <li class="non-active">Sales and loan amount</li>
                                <li class="non-active">Your offers</li>
                            </ul>
                        </div>
                        <h2 class="fs-title">Compare Title Quotes Free</h2>
                        <div class="select-form">
                            <input type="button" name="next" class="next action-button" (click)="setType('Purchase')" value="Purchase" />
                            <input type="button" name="next" class="next action-button" (click)="setType('Refinance')" value="Refinance" />
                        </div>
                    </fieldset>
                    <fieldset id="highForm">
                        <div class="progressbar-div" *ngIf="!contactForm">
                            <ul id="progressbar">
                                <li class="activated">Property info</li>
                                <li class="active">Sales and loan amount</li>
                                <li class="non-active">Your offers</li>
                            </ul>
                        </div>
                        <h2 class="fs-title">What is the property Address and Title's Regrads?</h2>
                        <div class="select-form">
                            <h3 class="fs-subtitle d-none d-sm-block">Property you are buying, selling or refinancing:</h3>
                            <div class="form-group" [ngClass]="{'has-error': isControlInvalid('price')}">
                                <input type="text" formControlName="price" id="price" placeholder="Purchase Price*"/>
                                <div class="error-msg" *ngIf="isControlInvalid('price')">This field is required</div>
                            </div>
                            <div class="form-group" [ngClass]="{'has-error': isControlInvalid('loanAmount')}">
                                <input type="text" formControlName="loanAmount" id="loanAmount" placeholder="Loan Amount*"/>
                                <div class="error-msg" *ngIf="isControlInvalid('loanAmount')">This field is required</div>
                            </div>
                            <div class="form-group">
                                <select formControlName="state" id="state" class="form-control custom-form">
                                    <option disabled [value]="states[0]">{{states[0]}}</option>
                                    <option [value]="states[1]">{{states[1]}}</option>
                                    <option [value]="states[2]">{{states[2]}}</option>
                                </select>
                                <div class="error-msg">This field is required</div>
                            </div>
                            <input type="button" name="previous" class="previous action-button-previous" value="Back"/>
                            <input
                                    type="button"
                                    name="next"
                                    class="next action-button"
                                    (click)="calculateTotals()"
                                    [disabled]="isControlInvalid('price') || isControlInvalid('loanAmount') ||
                                    isControlInvalid('zip') || actionUserForm.get('price').hasError('required') ||
                                    actionUserForm.get('loanAmount').hasError('required') || isInvalidState()" value="Next"/>
                        </div>
                    </fieldset>
                    <fieldset *ngIf="!contactForm">
                        <div class="progressbar-div" *ngIf="!contactForm">
                            <ul id="progressbar">
                                <li class="activated">Property info</li>
                                <li class="activated">Sales and loan amount</li>
                                <li class="active">Your offers</li>
                            </ul>
                        </div>
                        <h2 class="fs-title">Here are your offers</h2>
                        <div class="result-form">
                            <div class="container">
                                <div class="row">
                                    <div class="col">
                                        <table class="table">
                                            <tbody>
                                            <!-- content block -->
                                            <tr *ngFor="let company of accounts; let i = index" (click)="selectCompany(company.email, company.title)">
                                                <th class="hidden-xs align-middle">
                                                    <div class="hidden-xs hidden-sm card-avatar d-none d-md-block">
                                                        <a href="#avatar" *ngIf="company.data"><img [src]="company.data.image ? company.data.image : 'assets/img/default-user.png'" alt="..."></a>
                                                    </div>
                                                </th>
                                                <td>{{company.title || ''}}<br>
                                                    <star-rating-comp class="hidden-xs" [starType]="'svg'" [readOnly]="true" [rating]="company.rating"></star-rating-comp>
                                                    <a class="hidden-xs" *ngIf="company.website"  href="{{company.website}}" target="_blank">{{company.website}}</a>
                                                    <a class="hidden-xs" *ngIf="!company.website" href="#">Website</a>
                                                </td>
                                                <td class="align-middle" style="font-weight: 900; font-size: 1.3em;">{{company.total_price | currency:'USD':'symbol' || ''}}</td>
                                                <td class="align-middle">
                                                    <div class="form-check">
                                                        <ng-template #popContent>
                                                            Title Insurance: ${{company.totalInfo?.title_insurance}} <br>
                                                            Title Company Fees: ${{company.totalInfo?.companyFee}}<br>
                                                            Government Fees : ${{company.totalInfo?.government_fee}}<br></ng-template>
                                                        <label class="form-check-label">
                                                            <input type="button" name="next" class="action-button d-sm-block" value="Contact"
                                                                   (click)="selectCompany(company.email, company.title, company.address, company.website, company.phone)"
                                                                   [ngbPopover]="popContent"  triggers="mouseenter:mouseleave" popoverTitle="Price details" placement="left"/>
                                                            <i class="fa fa-phone fa-3x  fa-color d-block d-sm-none"></i>
                                                        </label>
                                                    </div>

                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>

                                    </div>
                            </div>
                        </div>
                    </div>
                        <!--
                        <input type="button" name="previous" class="previous action-button-previous" value="Back"/>
                        <input type="button" name="next" class="next action-button" value="Get Contacts"/>
                        -->
                    </fieldset>
                    <div id="contactForm" *ngIf="contactForm" [@contact]>
                        <div class="fs-title">
                                <h2 class="fs-title" style="padding-top: 0px; padding-bottom: 0px;">Contact Information</h2>
                        </div>

                        <h4 class="fs-output">We are going to send your information to: {{selectedCompanyTitle}}, {{selectedCompanyPhone}}, {{selectedCompanyAddress}}, {{selectedCompanyWebsite}}</h4>

                        <h3 class="fs-subtitle">Tell us more about you</h3>
                        <div class="form-group" [ngClass]="{'has-error': isControlInvalid('firstName')}">
                            <input formControlName="firstName" id="firstName" type="text" placeholder="First Name*"/>
                            <div class="error-msg">This field is required</div>
                        </div>
                        <div class="form-group" [ngClass]="{'has-error': isControlInvalid('lastName')}">
                            <input formControlName="lastName" id="lastName" type="text" placeholder="Last Name*"/>
                            <div class="error-msg">This field is required</div>
                        </div>
                        <div class="form-group" [ngClass]="{'has-error': isControlInvalid('email')}">
                            <input formControlName="email" id="email" type="text" placeholder="Email*"/>
                            <div class="error-msg">This field is required</div>
                        </div>
                        <div class="form-group" [ngClass]="{'has-error': isControlInvalid('phone')}">
                            <input formControlName="phone" id="phone" type="text" placeholder="Phone*"/>
                            <div class="error-msg">This field is required</div>
                        </div>
                        <div style="width: 30%;">
                            <input type="button"
                                   name="next"
                                   class="action-button"
                                   value="Get In Touch"
                                   (click)="send()"
                                   [disabled]="actionUserForm.get('firstName').hasError('required') ||
                                    actionUserForm.get('lastName').hasError('required') ||
                                    actionUserForm.get('email').hasError('required') ||
                                    actionUserForm.get('phone').hasError('required')"/>
                        </div>
                    </div>
                </form>
            </div>
        </div>
</div>

  


